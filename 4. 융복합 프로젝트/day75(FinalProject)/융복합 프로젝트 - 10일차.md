# ìœµë³µí•© í”„ë¡œì íŠ¸ - 10ì¼ì°¨



## mqttë¡œ ì´ë¯¸ì§€ ë³´ë‚´ê¸°



### ì‚¬ì§„ ì°ê¸°(Pub)

```python
import paho.mqtt.client as mqtt

mqtt = mqtt.Client("python_pub")
mqtt.connect("192.168.0.213", 1883, 60)
mqtt.publish("mydata/camera", "power")

mqtt.loop(2)
```



### ì‚¬ì§„ ì°ê¸°(Sub)

```python
import paho.mqtt.client as mqtt
from picamera import PiCamera
from time import sleep


camera = PiCamera()

camera.resolution = (2592,1944)
camera.framerate = 15
camera.brightness = 60
camera.awb_mode = 'horizon'
camera.start_preview()
sleep(5)

def on_connect(client, userdata, flags, rc):
    print("connect" + str(rc))
    if rc == 0:
        client.subscribe("mydata/camera")
    else:
        print("fail")

def on_message(client, userdata, msg):
    myval = msg.payload.decode("utf-8")
    if myval == "power":
        print(myval)
        camera.capture('/home/pi/image.jpg')
        camera.stop_preview()
    else:
        print("wrong")

mqttClient = mqtt.Client()

mqttClient.on_connect = on_connect

mqttClient.on_message = on_message

mqttClient.connect("192.168.0.213", 1883, 60)

mqttClient.loop_forever()
```



### ì´ë¯¸ì§€ ë³´ë‚´ê¸°(Pub)

```python
import paho.mqtt.publish as publish

f = open("/home/pi/image.jpg", 'rb')

filecontent = f.read()

byteArr = bytearray(filecontent)

publish.single('mydata/camera', byteArr, qos = 1, hostname = '192.168.0.213')
```



### ì´ë¯¸ì§€ ë³´ë‚´ê¸°(Sub)

```python
import paho.mqtt.client as mqtt

def on_connect(client, userdata, flags, rc):
    print("Connected" + str(rc))
    client.subscribe("mydata/camera")

def on_message(client, userdata, msg):
    f = open('receive.jpg', 'wb')
    f.write(msg.payload)
    f.close()
    print('received')

client = mqtt.Client()

client.on_connect = on_connect

client.on_message = on_message

client.connect("192.168.0.213", 1883, 60)

client.loop_forever()
```



### ë‘ ê°œ í•©ì¹˜ê¸°

```python
import paho.mqtt.client as mqtt
import paho.mqtt.publish as publish
from picamera import PiCamera
from time import sleep


camera = PiCamera()
camera.start_preview()
camera.resolution = (2592,1944)
camera.framerate = 15
camera.brightness = 60
sleep(5)

def on_connect(client, userdata, flags, rc):
    print("connect" + str(rc))
    if rc == 0:
        client.subscribe("mydata/camera")
    else:
        print("fail")

def on_message(client, userdata, msg):
    myval = msg.payload.decode('utf-8')
    if myval == "power":
        print(myval)

        camera.capture('/home/pi/image.jpg')

        camera.stop_preview()

        f = open("/home/pi/image.jpg")

        filecontent = f.read()

        byteArr = bytearray(filecontent)

        publish.single('mydata/camera', byteArr, qos=1, hostname='192.168.0.213')

    else:
        print("wrong")

mqttClient = mqtt.Client()

mqttClient.on_connect = on_connect

mqttClient.on_message = on_message

mqttClient.connect("192.168.0.213", 1883, 60)

mqttClient.loop_forever()
```



## íšŒì˜ë¡ ë° ê²°ê³¼ ë° í•  ì¼

- mqtt ì—°ìŠµ ë° êµ¬í˜„
- pcì—ì„œ pub ë©”ì‹œì§€, ë¼ì¦ˆë² ë¦¬íŒŒì´ì—ì„œ subë°›ëŠ”ê±° êµ¬í˜„
- pubì™€ subë¡œ ì¹´ë©”ë¼ ì°ëŠ” ì„¸íŒ…ê¹Œì§€ ì™„ë£Œ
- ì´ë¯¸ì§€ ë³´ë‚´ê¸° ì„±ê³µ!!!!
- 

# What did we do yesterday?

- íœ´ì‹



# What are we doing today?

- pcì™€ ë¼ì¦ˆë² ë¦¬íŒŒì´ í†µì‹ 
- ë°ì´í„° í¬ë¡¤ë§ , ì „ì²˜ë¦¬ , ë¼ë²¨ë§ , í•™ìŠµ ì‹œí‚¤ëŠ” ì¤‘ â†’ draft modelë¡œ ì´ê¸°ì¢…ê°„ í†µì‹  í™•ì¸
- 8ê°œ í´ë˜ìŠ¤ yolov5 ëª¨ë¸ ìƒì„± â†’ í…ŒìŠ¤íŠ¸ â†’ í†µì‹ ê¹Œì§€ í™•ì¸ ( í†µì‹ ì€ ì´ë²ˆ ì£¼ì— IoT ê´€ë ¨ ê³µë¶€ í›„ í•´ê²° ì˜ˆì • )
- class ì¤„ì´ê¸° â†’ 8ê°œì—ì„œ 3ê°œ or 4ê°œ â†’ ë°ì´í„° ìˆ˜ì§‘
- ë°ì´í„° ìˆ˜ì§‘ ê´€ë ¨ : ì¢…ë¥˜ ë³„ë¡œ ë‹¤ ì‹œí‚¤ê³  image generatorë¥¼ ì‚¬ìš©í•œ ë°ì´í„° + ìºê¸€ ë¶„ë¥˜ ë°ì´í„° = 80%ëŠ” í”Œë¼ìŠ¤í‹±ì— ê°ì¸ë˜ì–´ ìˆëŠ” ë°ì´í„° , 20%ëŠ” ë¶„ë¥˜í‘œì— í‘œì¤€ìœ¼ë¡œ ì í˜€ìˆëŠ” ì´ë¯¸ì§€ ë°ì´í„°
- í‘¸ë¦¬ì— ë³€í™˜ ê´€ë ¨ í…ŒìŠ¤íŠ¸ (ìŒê°) â†’ ëª»í•¨
- ì£¼ì œ ê´€ë ¨ ê¸°ì‚¬ , ì˜ìƒ, ë¶„ì„ ì½”ë“œ ë° ë°©ë²•ì— ëŒ€í•œ ì¡°ì‚¬
- Image Generator í…ŒìŠ¤íŠ¸
- í”„ë¡ íŠ¸ ì—”ë“œ ë² ì´ìŠ¤ ì œì‘ğŸ·

# Potential blockers?

- IoT í†µì‹  ë¬¸ì œ

# Action items

**Tip:** Type `@` followed by the name of a teammate to assign them to a task below.

- [ ]  MQTT í†µì‹  í™•ì¸
- [ ]  í•™ìŠµìš© ì´ë¯¸ì§€ ë°ì´í„°